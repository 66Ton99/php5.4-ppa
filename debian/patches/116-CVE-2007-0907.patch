diff -Nurp orig/main/SAPI.c new/main/SAPI.c
--- orig/main/SAPI.c	2007-02-21 08:48:51.000000000 +0100
+++ new/main/SAPI.c	2007-02-21 08:49:14.000000000 +0100
@@ -563,7 +563,7 @@ SAPI_API int sapi_header_op(sapi_header_
 	header_line = estrndup(header_line, header_line_len);
 
 	/* cut of trailing spaces, linefeeds and carriage-returns */
-	while(isspace(header_line[header_line_len-1])) 
+	while(header_line_len && isspace(header_line[header_line_len-1])) 
 		  header_line[--header_line_len]='\0';
 	
 	/* new line safety check */
